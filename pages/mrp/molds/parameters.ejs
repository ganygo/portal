<div class="row">
    <div class="col-md-12">
        <table class="table form-table table-bordered table-striped m-0"  cellspacing="0">
            <thead>
                <tr class="text-nowrap">
                    <th width="55%" class="">Parametre</th>
                    <th width="35%" class="">Değer</th>
                    <th width="80" class="text-center">
                        <a href="javascript:addNewParameter();" class="btn btn-primary far fa-plus-square"  title="Yeni satir"></a>
                    </th>
                </tr>
            </thead>
            <tbody id="parametersGrid">
                
            </tbody>
        </table>
    </div>
</div>

<script type="text/javascript">
    var moldParameters=JSON.parse(decodeURIComponent('<%- encodeURIComponent(JSON.stringify(form.moldParameters)) %>'));

    function loadmoldParameters(){
        $('#parametersGrid tr').remove();
        var parametersGrid=document.getElementById('parametersGrid');
        moldParameters.forEach(function(e,index){
            var newRow=parametersGrid.insertRow(parametersGrid.rows.length);
            newRow.insertCell(0).innerHTML='<input type="text" class="form-control" name="moldParameters[' + index + '][name]" placeholder="Parametre ' + (index+1).toString() + '" value="' + e.name +'" <% if(mode=="view"){%> readonly="true" <%}%>>';
            newRow.insertCell(1).innerHTML='<input type="text" class="form-control" name="moldParameters[' + index + '][value]" placeholder="değer" value="' + e.value +'" <% if(mode=="view"){%> readonly="true" <%}%>>';
            var cell2=newRow.insertCell(2);
            cell2.classList.add('text-center');
            cell2.innerHTML='<a href="javascript:removeParameter(' + index + ');" class="btn btn-danger fas fa-trash-alt"  title="Satir sil"></a>';
        });
    }

    function addNewParameter(){
        <% if(mode=="view"){%> 
            return;
        <%}%>
        moldParameters.push({name:'Yeni parametre ' + (moldParameters.length + 1).toString(),value:''});
        var parametersGrid=document.getElementById('parametersGrid');
        var index=moldParameters.length-1;
        var newRow=parametersGrid.insertRow(index);
        newRow.insertCell(0).innerHTML='<input type="text" class="form-control" name="moldParameters[' + index + '][name]" placeholder="Parametre ' + (index+1).toString() + '" value="' + moldParameters[index].name +'">';
        newRow.insertCell(1).innerHTML='<input type="text" class="form-control" name="moldParameters[' + index + '][value]" placeholder="değer" value="' + moldParameters[index].value +'">';
        var cell2=newRow.insertCell(2);
        cell2.classList.add('text-center');
        cell2.innerHTML='<a href="javascript:removeParameter(' + index + ');" class="btn btn-danger fas fa-trash-alt"  title="Satir sil"></a>';
    }

    function removeParameter(removeIndex){
        <% if(mode=="view"){%> 
            return;
        <%}%>
        if(confirm('Kalıp parametresini silmek istediginizden emin misiniz?')==false) return;
        moldParameters.forEach(function(e,index){
            e.name=$('input[name="moldParameters[' + index + '][name]"]').val();
            e.value=$('input[name="moldParameters[' + index + '][value]"]').val();
        });
        moldParameters.splice(removeIndex,1);
        loadmoldParameters();
    }

    $(document).ready(function(){

        loadmoldParameters();
    })
</script>